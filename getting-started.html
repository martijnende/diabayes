
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Getting started &#8212; DiaBayes  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting-started';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user-guide/index.html" />
    <link rel="prev" title="DiaBayes documentation" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">DiaBayes  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Getting started</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h1>
<section id="installation-guide">
<h2>Installation guide<a class="headerlink" href="#installation-guide" title="Link to this heading">#</a></h2>
<p>It is recommended to create a dedicated Python environment using either <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">venv</span></code>. DiaBayes will install numerous JAX-related packages that might conflict with your existing Python environments, especially when GPU support is enabled (which installs CUDA binaries). To create a new environment using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>diabayes<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.11<span class="w"> </span>pip
conda<span class="w"> </span>activate<span class="w"> </span>diabayes
</pre></div>
</div>
<p>You can then install the latest version using <code class="docutils literal notranslate"><span class="pre">pip</span></code> directly from GitHub:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;git+https://github.com/martijnende/diabayes.git#egg=diabayes&quot;</span>
</pre></div>
</div>
<p>To enable Nvidia GPU support (CUDA version 12):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;git+https://github.com/martijnende/diabayes.git#egg=diabayes[gpu]&quot;</span>
</pre></div>
</div>
<p>If you plan to make direct changes to the code base, you can clone the repository and install from the local repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/martijnende/diabayes.git
<span class="nb">cd</span><span class="w"> </span>diabayes
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="o">[</span>gpu<span class="o">]</span>
</pre></div>
</div>
<p>Note that you’ll need to repeat <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> every time you make changes. If you also plan to push these changes to the original DiaBayes project, please include the development and documentation tools:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>.<span class="o">[</span>gpu,docs,dev<span class="o">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dev</span></code> packages include <a class="reference external" href="https://github.com/psf/black"><code class="docutils literal notranslate"><span class="pre">black</span></code></a> and <a class="reference external" href="https://github.com/PyCQA/isort"><code class="docutils literal notranslate"><span class="pre">isort</span></code></a>, which (re-)structure your code to a consistent format whenever you execute these in the repository root directory.</p>
</section>
<section id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To clarify the notation used throughout the documentation:</p>
<ul class="simple">
<li><p>A <em>variable</em> is a quantity that potentially varies over time.</p></li>
<li><p>A <em>parameter</em> is a constant quantity that one might want to invert for.</p></li>
<li><p>A <em>constant</em> is a user-defined constant quantity that remains untouched throughout inversion procedures.</p></li>
</ul>
</div>
<section id="forward-models">
<h3>Forward models<a class="headerlink" href="#forward-models" title="Link to this heading">#</a></h3>
<p>The physics that underlies your experiment is encoded by a <em>forward model</em>. A DiaBayes <code class="docutils literal notranslate"><span class="pre">Forward</span></code> model is composed of three components:</p>
<ol class="arabic simple">
<li><p>A friction law, which is an equation that takes the friction and one or more “state” variables as an input, and returns the instantaneous slip rate as an output, i.e. <span class="math notranslate nohighlight">\(v(t) = f(\mu(t), \theta(t), \phi(t), \dots)\)</span>.</p></li>
<li><p>A state evolution law, which returns the time derivative of the “state” variable(s).</p></li>
<li><p>A stress transfer model, which describes how the local slip rate results in a change in shear stress on the fault interface.</p></li>
</ol>
<p>These three components can be mixed and matched according to the user’s needs. For example, one could compile a forward model with regularised rate-and-state friction, the slip law for state evolution, and a non-inertial spring-block analogue for the stress transfer. Or one could pick the <em>Chen-Niemeijer-Spiers</em> friction model with its corresponding state (porosity) evolution law coupled with an inertial spring-block to simulate stick-slip motion. See the <a class="reference internal" href="user-guide/forward/index.html"><span class="doc std std-doc">User Guide on forward modelling</span></a> for more information about the various forward model components that have been implemented.</p>
<p>Here is an example of a classical rate-and-state friction model combined with the ageing law and a non-inertial spring-block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diabayes.forward_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Forward</span><span class="p">,</span> <span class="n">rsf</span><span class="p">,</span> <span class="n">ageing_law</span><span class="p">,</span> <span class="n">springblock</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;theta&quot;</span><span class="p">:</span> <span class="n">ageing_law</span><span class="p">}</span>
<span class="n">forward</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">(</span><span class="n">friction_model</span><span class="o">=</span><span class="n">rsf</span><span class="p">,</span> <span class="n">state_evolution</span><span class="o">=</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">block_type</span><span class="o">=</span><span class="n">springblock</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">rsf</span></code> friction model uses only a single state variable (<code class="docutils literal notranslate"><span class="pre">theta</span></code>), but other friction models could accept several. The structure of the <code class="docutils literal notranslate"><span class="pre">state_dict</span></code> is <code class="docutils literal notranslate"><span class="pre">{&quot;variable_name1&quot;:</span> <span class="pre">variable_evolution1,</span> <span class="pre">&quot;variable_name2&quot;:</span> <span class="pre">variable_evolution2,</span> <span class="pre">...}</span></code>. In other words, every state variable has a unique name and exactly one function that describes the evolution of this variable. The variable names need to correspond with what is expected by the friction law; see the documentation of each friction law for a description.</p>
<p>This forward model can then be handed over to a solver that takes care of the forward (and inverse) modelling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diabayes.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">ODESolver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ODESolver</span><span class="p">(</span><span class="n">forward_model</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the forward/inverse models need to accommodate any kind of physics that come with their own quantities, DiaBayes implements special containers that allows access to these quantities by name (rather than by position inside an array, which is not known ahead of time). For constant quantities (parameters and constants), the user can import the relevant containers and set these quantities directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">diabayes</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">db</span>

<span class="c1"># RSF parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">RSFParams</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">Dc</span><span class="o">=</span><span class="n">Dc</span><span class="p">)</span>
<span class="c1"># RSF constants</span>
<span class="n">constants</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">RSFConstants</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">mu0</span><span class="o">=</span><span class="n">mu0</span><span class="p">)</span>
<span class="c1"># Spring-block constants</span>
<span class="n">block_constants</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">SpringBlockConstants</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">v_lp</span><span class="o">=</span><span class="n">v1</span><span class="p">)</span>
</pre></div>
</div>
<p>Time-dependent variables are a bit special, and so they need to be set through the <code class="docutils literal notranslate"><span class="pre">Forward</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span> <span class="o">=</span> <span class="n">Dc</span> <span class="o">/</span> <span class="n">v0</span>
<span class="n">forward</span><span class="o">.</span><span class="n">set_initial_values</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta0</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">forward</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
<p>Since we initially provided just one state evolution equation, there is only one state variable to specify in addition to the friction coefficient. In this example <code class="docutils literal notranslate"><span class="pre">forward.variables</span></code> points to a <code class="docutils literal notranslate"><span class="pre">Variables</span></code> class, and we can access the various quantities like <code class="docutils literal notranslate"><span class="pre">params.Dc</span></code>, <code class="docutils literal notranslate"><span class="pre">block_constants.k</span></code>, <code class="docutils literal notranslate"><span class="pre">y0.theta</span></code>, etc.</p>
<p>The last step is to get a forward solution from DiaBayes, which is a single function call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve_forward</span><span class="p">(</span>
    <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
    <span class="n">friction_constants</span><span class="o">=</span><span class="n">constants</span><span class="p">,</span>
    <span class="n">block_constants</span><span class="o">=</span><span class="n">block_constants</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">result</span></code> is a <code class="docutils literal notranslate"><span class="pre">Variables</span></code> container that contains the time series of the relevant variables (e.g. friction and state for rate-and-state friction) that can be accessed e.g. through <code class="docutils literal notranslate"><span class="pre">result.mu</span></code>, <code class="docutils literal notranslate"><span class="pre">result.theta</span></code>, etc.</p>
</section>
<section id="inversion">
<h3>Inversion<a class="headerlink" href="#inversion" title="Link to this heading">#</a></h3>
<p>DiaBayes currently has two flavours if inversion implemented. The <em>maximum-likelihood</em> inversion uses the Levenberg-Marquardt method with adjoint back-propagation through the ODE to search for a single set of physical parameters that minimise the misfit between the predicted friction curve and the measured one. The second flavour is a form of <em>Bayesian inversion</em>, which estimates the probability that a given set of parameters describes the observed friction within the measurement uncertainties. See the <a class="reference internal" href="user-guide/inversion/index.html"><span class="doc std std-doc">User Guide on inverse modelling</span></a> for an in-depth discussion of these two inversion approaches.</p>
<p>Performing a maximum-likelihood inversion involves a single function call that has a similar signature as the forward solver:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mu_measured</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">initial_guess_params</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">inv_result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">max_likelihood_inversion</span><span class="p">(</span>
    <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu_measured</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">initial_guess_params</span><span class="p">,</span>
    <span class="n">friction_constants</span><span class="o">=</span><span class="n">constants</span><span class="p">,</span>
    <span class="n">block_constants</span><span class="o">=</span><span class="n">block_constants</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The return value <code class="docutils literal notranslate"><span class="pre">inv_result</span></code> is an <a class="reference external" href="https://docs.kidger.site/optimistix/api/solution/#optimistix.Solution"><code class="docutils literal notranslate"><span class="pre">optimistix.Solution</span></code></a> object that contains the maximum-likelihood solution of the parameters, as well as diagnostic information. This maximum-likelihood estimate can then be used for subsequent Bayesian inversion to estimate the uncertainties and trade-offs in the parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params_inv</span> <span class="o">=</span> <span class="n">inv_result</span><span class="o">.</span><span class="n">value</span>
<span class="n">noise_amplitude</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># Estimate of the measurement uncertainty</span>
<span class="n">bayesian_result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">bayesian_inversion</span><span class="p">(</span>
    <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu_measured</span><span class="p">,</span> <span class="n">noise_std</span><span class="o">=</span><span class="n">noise_amplitude</span><span class="p">,</span> 
    <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params_inv</span><span class="p">,</span> <span class="n">friction_constants</span><span class="o">=</span><span class="n">constants</span><span class="p">,</span> 
    <span class="n">block_constants</span><span class="o">=</span><span class="n">block_constants</span><span class="p">,</span> 
    <span class="n">Nparticles</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">Nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this example, the posterior distribution is estimated by means of a particle swarm consisting of 1500 particles, which converge to an equilibrium over 100 steps.</p>
<p>The return value of <code class="docutils literal notranslate"><span class="pre">bayesian_inversion</span></code> is a <code class="docutils literal notranslate"><span class="pre">BayesianSolution</span></code> object, which not only contains the posterior samples, but also several diagnostic and visualisation routines. To evaluate whether the inversion converged to an equilibrium state, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bayesian_result</span><span class="o">.</span><span class="n">plot_convergence</span><span class="p">();</span>
</pre></div>
</div>
<p>To visualise the posterior distributions over the inverted parameters, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bayesian_result</span><span class="o">.</span><span class="n">cornerplot</span><span class="p">();</span>
</pre></div>
</div>
<p>To draw samples from the posterior distribution (<code class="docutils literal notranslate"><span class="pre">samples</span></code>), and their corresponding friction time series (<code class="docutils literal notranslate"><span class="pre">sample_results</span></code>), use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="p">,</span> <span class="n">sample_results</span> <span class="o">=</span> <span class="n">bayesian_result</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="n">solver</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
    <span class="n">constants</span><span class="p">,</span> 
    <span class="n">block_constants</span><span class="p">,</span>
    <span class="n">nsamples</span><span class="o">=</span><span class="mi">100</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/simple_example.ipynb</span></code> for a basic tutorial on how to use DiaBayes in practice.</p>
</section>
<section id="getting-help">
<h2>Getting help<a class="headerlink" href="#getting-help" title="Link to this heading">#</a></h2>
<p>If it is unclear on how to use the DiaBayes API, if you encountered a bug, or if you want to contribute a new feature, head over to the <a class="reference internal" href="community.html"><span class="doc std std-doc">DiaBayes Community page</span></a>. There you will find useful links and resources, frequently encountered issues, and suggestions.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">DiaBayes documentation</p>
      </div>
    </a>
    <a class="right-next"
       href="user-guide/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-guide">Installation guide</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-usage">Basic usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-models">Forward models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion">Inversion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-help">Getting help</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Martijn van den Ende.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>