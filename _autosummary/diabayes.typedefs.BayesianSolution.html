
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>diabayes.typedefs.BayesianSolution &#8212; DiaBayes  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_autosummary/diabayes.typedefs.BayesianSolution';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Forward models" href="../api/forward_models.html" />
    <link rel="prev" title="diabayes.typedefs.StateDict" href="diabayes.typedefs.StateDict.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">DiaBayes  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../api/typedefs.html">Data containers</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="diabayes.typedefs.Variables.html">diabayes.typedefs.Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.typedefs.StateDict.html">diabayes.typedefs.StateDict</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">diabayes.typedefs.BayesianSolution</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/forward_models.html">Forward models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.Forward.html">diabayes.forward_models.Forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.rsf.html">diabayes.forward_models.rsf</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.ageing_law.html">diabayes.forward_models.ageing_law</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.aging_law.html">diabayes.forward_models.aging_law</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.slip_rate.html">diabayes.forward_models.slip_rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.springblock.html">diabayes.forward_models.springblock</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.forward_models.inertial_springblock.html">diabayes.forward_models.inertial_springblock</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/solver.html">Solver routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="diabayes.solver.ODESolver.html">diabayes.solver.ODESolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.solver.ODESolver.bayesian_inversion.html">diabayes.solver.ODESolver.bayesian_inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.solver.ODESolver.max_likelihood_inversion.html">diabayes.solver.ODESolver.max_likelihood_inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="diabayes.solver.ODESolver.solve_forward.html">diabayes.solver.ODESolver.solve_forward</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/svi.html">Stein Variational Inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="diabayes.SVI.compute_phi.html">diabayes.SVI.compute_phi</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api/index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="../api/typedefs.html" class="nav-link">Data containers</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">diabayes.typedefs.BayesianSolution</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="diabayes-typedefs-bayesiansolution">
<h1>diabayes.typedefs.BayesianSolution<a class="headerlink" href="#diabayes-typedefs-bayesiansolution" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diabayes.typedefs.</span></span><span class="sig-name descname"><span class="pre">BayesianSolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.RSFParams" title="diabayes.typedefs.RSFParams"><span class="pre">RSFParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.CNSParams" title="diabayes.typedefs.CNSParams"><span class="pre">CNSParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/diabayes/typedefs.html#BayesianSolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diabayes.typedefs.BayesianSolution" title="Link to this definition">#</a></dt>
<dd><p>The result of a Bayesian inversion. This data class stores the
particle trajectories (equivalent of MCMC chains), the final
equilibrum state, and various statistcs, as well as helper
routines to diagnose or visualise the results.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">bayesian_inversion</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">nan_count</span><span class="p">)</span>  <span class="c1"># Check for NaN values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">statistics</span><span class="o">.</span><span class="n">Dc</span><span class="o">.</span><span class="n">median</span><span class="p">)</span>  <span class="c1"># Get the median of Dc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">plot_convergence</span><span class="p">()</span>  <span class="c1"># Visually inspect convergence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">cornerplot</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># Create a cornerplot</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.RSFParams" title="diabayes.typedefs.RSFParams"><span class="pre">RSFParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.CNSParams" title="diabayes.typedefs.CNSParams"><span class="pre">CNSParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/diabayes/typedefs.html#BayesianSolution.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#diabayes.typedefs.BayesianSolution.__init__" title="diabayes.typedefs.BayesianSolution.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(log_params, log_likelihood, nan_count)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.cornerplot" title="diabayes.typedefs.BayesianSolution.cornerplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cornerplot</span></code></a>([nbins])</p></td>
<td><p>Create a corner plot from the particle positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.plot_convergence" title="diabayes.typedefs.BayesianSolution.plot_convergence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_convergence</span></code></a>()</p></td>
<td><p>Helper routine to visualise the convergence of the inversion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.sample" title="diabayes.typedefs.BayesianSolution.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(solver, y0, t, friction_constants, ...)</p></td>
<td><p>Draw random samples from the posterior distribution.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Attributes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.statistics" title="diabayes.typedefs.BayesianSolution.statistics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">statistics</span></code></a></p></td>
<td><p>Pre-computed statistics of the parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.log_params" title="diabayes.typedefs.BayesianSolution.log_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_params</span></code></a></p></td>
<td><p>The particles representing the (log-valued) parameters, including all the iteration steps</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.chains" title="diabayes.typedefs.BayesianSolution.chains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chains</span></code></a></p></td>
<td><p>The particle trajectories (to inspect convergence)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.log_likelihood" title="diabayes.typedefs.BayesianSolution.log_likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likelihood</span></code></a></p></td>
<td><p>The log-likelihood evolution</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.nan_count" title="diabayes.typedefs.BayesianSolution.nan_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nan_count</span></code></a></p></td>
<td><p>The number of NaNs encountered during each iteration step</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.BayesianSolution.final_state" title="diabayes.typedefs.BayesianSolution.final_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">final_state</span></code></a></p></td>
<td><p>The final state of the particle swarm</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.cornerplot">
<span class="sig-name descname"><span class="pre">cornerplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/diabayes/typedefs.html#BayesianSolution.cornerplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.cornerplot" title="Link to this definition">#</a></dt>
<dd><p>Create a corner plot from the particle positions. For <cite>N</cite>
parameters, a corner plot is the lower half of an <cite>N x N</cite>
grid of subplots. On the diagonal, the histogram of the
marginal posterior over the <cite>i-th</cite> parameter is plotted.
Below the diagonal, the <cite>(i,j)</cite>-th panel is a scatter
plot of parameter <cite>i</cite> against parameter <cite>j</cite>, which shows
the co-variance between the two quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nbins</strong> (<em>int</em>) – The number of bins to use for the histograms on the
diagonal of the corner plot</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object that can be manipulated after creation
(e.g. to save to disk)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.plot_convergence">
<span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/diabayes/typedefs.html#BayesianSolution.plot_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.plot_convergence" title="Link to this definition">#</a></dt>
<dd><p>Helper routine to visualise the convergence of the inversion.
Convergence is achieved when the particles settle in an
equilibrium position (i.e., they stop moving).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fig</strong> – The figure object that can be manipulated after creation
(e.g. to save to disk)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.pyplot.figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.Variables" title="diabayes.typedefs.Variables"><span class="pre">Variables</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nt'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">friction_constants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.RSFConstants" title="diabayes.typedefs.RSFConstants"><span class="pre">RSFConstants</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_constants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.SpringBlockConstants" title="diabayes.typedefs.SpringBlockConstants"><span class="pre">SpringBlockConstants</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.InertialSpringBlockConstants" title="diabayes.typedefs.InertialSpringBlockConstants"><span class="pre">InertialSpringBlockConstants</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/diabayes/typedefs.html#BayesianSolution.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.sample" title="Link to this definition">#</a></dt>
<dd><p>Draw random samples from the posterior distribution. Each
particle should represent one realisation of a plausible
friction curve. For <code class="docutils literal notranslate"><span class="pre">nsamples</span></code> realisations requested by a
user, it is more beneficial to <cite>vmap</cite> the forward simulations
rather than compute them one by one.</p>
<p>The resulting friction curves can be used for validation
purposes (does the posterior match the data?).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">bayesian_inversion</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="p">,</span> <span class="n">sample_results</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">friction_constants</span><span class="o">=</span><span class="n">constants</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">block_constants</span><span class="o">=</span><span class="n">block_constants</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">nsamples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> (<a class="reference internal" href="../api/diabayes.html#diabayes.solver.ODESolver" title="diabayes.solver.ODESolver"><em>ODESolver</em></a>) – The <code class="docutils literal notranslate"><span class="pre">ODESolver</span></code> class instantiated with the <code class="docutils literal notranslate"><span class="pre">Forward</span></code>
model (typically the same one as used for the inversion)</p></li>
<li><p><strong>y0</strong> (<a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.Variables" title="diabayes.typedefs.Variables"><em>Variables</em></a>) – The initial values of friction and state</p></li>
<li><p><strong>t</strong> (<em>Array</em>) – The time samples at which a solution is requested. This
does not need to be the same as the time samples recorded
in the experiment (from which the observed friction curve
is obtained)</p></li>
<li><p><strong>friction_constants</strong> (<em>_Constants</em>) – The friction and state model constants</p></li>
<li><p><strong>block_constants</strong> (<em>_BlockConstants</em>) – The stress transfer constants</p></li>
<li><p><strong>nsamples</strong> (<em>int</em>) – The number of random samples for which a solution should
be computed</p></li>
<li><p><strong>rng</strong> (<em>None</em><em>, </em><em>int</em><em>, </em><em>jax.random.PRNGKey</em>) – The random seed used to sample from the particle distribution.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current time will be used as a seed, which leads
to different result for each realisation. When an integer is
provided, a new <code class="docutils literal notranslate"><span class="pre">jax.random.PRNGKey</span></code> is generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>samples</strong> (<em>_Params</em>) – The samples drawn from the posterior distribution</p></li>
<li><p><strong>sample_results</strong> (<em>Variables</em>) – The forward simulation results corresponding with <code class="docutils literal notranslate"><span class="pre">samples</span></code></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.chains">
<span class="sig-name descname"><span class="pre">chains</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps</span> <span class="pre">Nparticles</span> <span class="pre">Nparams'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.chains" title="Link to this definition">#</a></dt>
<dd><p>The particle trajectories (to inspect convergence)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.final_state">
<span class="sig-name descname"><span class="pre">final_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nparticles</span> <span class="pre">Nparams'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.final_state" title="Link to this definition">#</a></dt>
<dd><p>The final state of the particle swarm</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.log_likelihood" title="Link to this definition">#</a></dt>
<dd><p>The log-likelihood evolution</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.log_params">
<span class="sig-name descname"><span class="pre">log_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.RSFParams" title="diabayes.typedefs.RSFParams"><span class="pre">RSFParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.CNSParams" title="diabayes.typedefs.CNSParams"><span class="pre">CNSParams</span></a></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.log_params" title="Link to this definition">#</a></dt>
<dd><p>The particles representing the (log-valued) parameters,
including all the iteration steps</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.nan_count">
<span class="sig-name descname"><span class="pre">nan_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Nsteps'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.nan_count" title="Link to this definition">#</a></dt>
<dd><p>The number of NaNs encountered during each iteration step</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diabayes.typedefs.BayesianSolution.statistics">
<span class="sig-name descname"><span class="pre">statistics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.RSFStatistics" title="diabayes.typedefs.RSFStatistics"><span class="pre">RSFStatistics</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../api/diabayes.html#diabayes.typedefs.CNSStatistics" title="diabayes.typedefs.CNSStatistics"><span class="pre">CNSStatistics</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#diabayes.typedefs.BayesianSolution.statistics" title="Link to this definition">#</a></dt>
<dd><p>Pre-computed statistics of the parameters</p>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="diabayes.typedefs.StateDict.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">diabayes.typedefs.StateDict</p>
      </div>
    </a>
    <a class="right-next"
       href="../api/forward_models.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Forward models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution"><code class="docutils literal notranslate"><span class="pre">BayesianSolution</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.__init__"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.cornerplot"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.cornerplot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.plot_convergence"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.plot_convergence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.sample"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.chains"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.chains</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.final_state"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.final_state</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.log_likelihood"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.log_likelihood</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.log_params"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.log_params</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.nan_count"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.nan_count</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diabayes.typedefs.BayesianSolution.statistics"><code class="docutils literal notranslate"><span class="pre">BayesianSolution.statistics</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Martijn van den Ende.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>