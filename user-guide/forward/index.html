
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Forward modelling &#8212; DiaBayes  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/forward/index';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rate-and-state friction" href="rate-and-state.html" />
    <link rel="prev" title="User Guide" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">DiaBayes  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community.html">
    DiaBayes Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Forward modelling</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="rate-and-state.html">Rate-and-state friction</a></li>
<li class="toctree-l2"><a class="reference internal" href="chen-niemeijer-spiers.html">Chen-Niemeijer-Spiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring-block.html">Spring-blocks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../inversion/index.html">Inverse modelling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inversion/max-likelihood.html">Maximum-likelihood inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inversion/bayesian.html">Bayesian inversion</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_usage.html">Advanced use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_features.html">Adding custom physics</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Forward modelling</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="forward-modelling">
<h1>Forward modelling<a class="headerlink" href="#forward-modelling" title="Link to this heading">#</a></h1>
<p>A fundamental aspect of any quantitative science discipline is to make observations. These observations are generated by some physical (or chemical, biological, …) process. A <em>forward model</em> is a mathematical description of this process, which is often expressed as a <em>differential equation</em>; while the observations that we make can look extremely complex (e.g. planetary objects orbiting a star), the dynamics underlying this behaviour are often much simpler to describe (Newton’s laws of motion). We can then generate synthetic observations by solving the dynamics forward in time, given some set of parameters and initial conditions.</p>
<p>Quantitatively, the dynamics of a system with multiple variables or dimensions can be written as:</p>
<div class="math notranslate nohighlight" id="equation-ode">
<span class="eqno">(1)<a class="headerlink" href="#equation-ode" title="Link to this equation">#</a></span>\[\frac{\mathrm{d} \vec{X}}{\mathrm{d} t} = f\left( t, \vec{X}, \dots \right)\]</div>
<p>The synthetic observations are then generated by integrating Eq. <a class="reference internal" href="#equation-ode">(1)</a> over time <span class="math notranslate nohighlight">\(t \in \left[ t_0, t \right)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ode-solution">
<span class="eqno">(2)<a class="headerlink" href="#equation-ode-solution" title="Link to this equation">#</a></span>\[\vec{X}(t) = \vec{X}(t=t_0) + \int_{t_0}^{t} f\left(t', \vec{X}, \dots \right) \mathrm{d} t'\]</div>
<p>There exists a plethora of strategies to perform the integration as indicated above in a stable and accurate manner: Runge-Kutta, Rosenbrock, LSODA, … DiaBayes uses the <a class="reference external" href="https://docs.kidger.site/diffrax/">Diffrax</a> library <span id="id1">[<a class="reference internal" href="#id4" title="Patrick Kidger. On Neural Differential Equations. PhD thesis, University of Oxford, 2021.">1</a>]</span>, which implements several of these solvers in JAX. A good general-purpose solver is the <a class="reference external" href="https://docs.kidger.site/diffrax/api/solvers/ode_solvers/#diffrax.Tsit5"><code class="docutils literal notranslate"><span class="pre">Tsit5</span></code></a> algorithm, which is the default for DiaBayes.</p>
<section id="friction-models">
<h2>Friction models<a class="headerlink" href="#friction-models" title="Link to this heading">#</a></h2>
<p>A typical forward model describing a rock friction experiment comprises 3 components: a <em>friction law</em> that describes the slip rate of the fault in response to a given state of stress (or “friction”), a <em>state evolution law</em> that controls the time- and history-dependent internal state of the fault, and a model that describes how the externally imposed stress is transmitted to the fault (usually through elasticity). To make this more concrete, let’s consider a classical spring-block model governed by rate-and-state friction <span id="id2">[<a class="reference internal" href="#id5" title="Chris Marone. On the rate of frictional healing and the constitutive law for time- and slip-dependent friction. International Journal of Rock Mechanics and Mining Sciences, 1997. doi:10.1016/s1365-1609(97)00054-3.">2</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-rsf">
<span class="eqno">(3)<a class="headerlink" href="#equation-rsf" title="Link to this equation">#</a></span>\[\begin{split}\frac{\mathrm{d} \vec{X}}{\mathrm{d} t} = \begin{cases}
\dot{\mu} = k \left(v_{lp} - v(\mu, \theta) \right) \quad \text{(spring-block stress transfer)} \\
\dot{\theta} = 1 - \frac{v \theta}{D_c} \quad \text{(Ageing law state evolution)}
\end{cases}\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[v(\mu, \theta) = v_0 \exp \left( \frac{1}{a} \left[ \mu - \mu_0 - b \ln \left( \frac{v_0 \theta}{D_c} \right) \right] \right)\]</div>
<p>In the above expressions, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(D_c\)</span> are frictional parameters that are often of interest, and <a class="reference internal" href="../inversion/index.html"><span class="doc std std-doc">can be inverted for</span></a> from measured friction curves (<span class="math notranslate nohighlight">\(\mu(t)\)</span>). The friction parameters <span class="math notranslate nohighlight">\(\mu_0\)</span> and <span class="math notranslate nohighlight">\(v_0\)</span> are typically taken as constants as they can be inferred directly from the data. The spring-block stiffness <span class="math notranslate nohighlight">\(k\)</span> and the load-point velocity <span class="math notranslate nohighlight">\(v_{lp}\)</span> are determined by the experimental set-up. The forward model is completed by a description of the evolution of the state <span class="math notranslate nohighlight">\(\theta\)</span> (here the Ageing law was chosen). Integrating Eq. <a class="reference internal" href="#equation-rsf">(3)</a> over time yields <span class="math notranslate nohighlight">\(\vec{X}(t) = \left[ \mu(t), \theta(t) \right]^\intercal\)</span>.</p>
<p>The formulations above are merely a classical example of a friction forward model. There are several other models for the friction law, state evolution, and the stress transfer, that can be used (and in some cases combined in different ways). For more background on the various models that have been implemented, see the sections on <a class="reference internal" href="rate-and-state.html"><span class="doc std std-doc">rate-and-state</span></a> models, the <a class="reference internal" href="chen-niemeijer-spiers.html"><span class="doc std std-doc">Chen-Niemeijer-Spiers</span></a> model, and <a class="reference internal" href="spring-block.html"><span class="doc std std-doc">spring-block</span></a> models.</p>
<p>The remainder of this section is dedicated to the practical implementation of forward models in DiaBayes.</p>
</section>
<section id="implementation-in-diabayes">
<h2>Implementation in DiaBayes<a class="headerlink" href="#implementation-in-diabayes" title="Link to this heading">#</a></h2>
<p>DiaBayes provides a generalised interface that takes the three (compatible) forward components as an input, and connects them together into a form equivalent to Eq. <a class="reference internal" href="#equation-ode">(1)</a>. This interface is accessed through the <code class="docutils literal notranslate"><span class="pre">diabayes.forward_models.Forward</span></code> class. The forward model expressed by Eq. <a class="reference internal" href="#equation-rsf">(3)</a> is constructed as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diabayes.forward_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Forward</span><span class="p">,</span> <span class="n">rsf</span><span class="p">,</span> <span class="n">ageing_law</span><span class="p">,</span> <span class="n">springblock</span>
<span class="n">forward</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">(</span><span class="n">friction_model</span><span class="o">=</span><span class="n">rsf</span><span class="p">,</span> <span class="n">state_evolution</span><span class="o">=</span><span class="n">ageing_law</span><span class="p">,</span> <span class="n">block_type</span><span class="o">=</span><span class="n">springblock</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Forward</span></code> class implements a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method that, when given the appropriate variables (<span class="math notranslate nohighlight">\(\vec{X}\)</span>), parameters (<span class="math notranslate nohighlight">\(\left\{ a, b, D_c \right\}\)</span>), friction constants (<span class="math notranslate nohighlight">\(\left\{ \mu_0, v_0 \right\}\)</span>), and spring-block constants (<span class="math notranslate nohighlight">\(\left\{ k, v_{lp} \right\}\)</span>), yields <span class="math notranslate nohighlight">\(\mathrm{d} \vec{X} / \mathrm{d} t\)</span>. The <code class="docutils literal notranslate"><span class="pre">forward</span></code> class instance is passed to an ODE solver, which will successively call <code class="docutils literal notranslate"><span class="pre">forward(...)</span></code> to obtain the time derivatives for integration.</p>
<p>To enable the assembly of a forward model from the three components, each component needs to follow a specific call signature. These are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">friction_model</span><span class="p">(</span><span class="n">variables</span><span class="p">:</span> <span class="n">Variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">_Params</span><span class="p">,</span> <span class="n">friction_constants</span><span class="p">:</span> <span class="n">_Constants</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float</span><span class="p">:</span>
    <span class="n">velocity</span><span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">velocity</span>

<span class="k">def</span><span class="w"> </span><span class="nf">state_evolution</span><span class="p">(</span><span class="n">variables</span><span class="p">:</span> <span class="n">Variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">_Params</span><span class="p">,</span> <span class="n">friction_constants</span><span class="p">:</span> <span class="n">_Constants</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float</span><span class="p">:</span>
    <span class="n">state_change</span><span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">state_change</span>

<span class="k">def</span><span class="w"> </span><span class="nf">block_type</span><span class="p">(</span><span class="n">velocity</span><span class="p">:</span> <span class="n">Float</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="n">Variables</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">_BlockConstants</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float</span><span class="p">:</span>
    <span class="n">friction_change</span><span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">friction_change</span>
</pre></div>
</div>
<p>The type annotations <code class="docutils literal notranslate"><span class="pre">Variables</span></code>, <code class="docutils literal notranslate"><span class="pre">_Params</span></code>, <code class="docutils literal notranslate"><span class="pre">_Constants</span></code>, and <code class="docutils literal notranslate"><span class="pre">_BlockConstants</span></code> are defined in <code class="docutils literal notranslate"><span class="pre">diabayes.typedefs</span></code>, and they represent special containers holding the expected items that can be accessed by name. The contents of the containers are specific to a given model (as each model has its own variables and parameters). Note that each function above returns a scalar; vectorised computations are handled at a higher level by <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.vmap.html"><code class="docutils literal notranslate"><span class="pre">vmap</span></code></a>ing the forward model.</p>
<p>Any new implementations of physics (see <a class="reference internal" href="../adding_features.html"><span class="doc std std-doc">Adding custom physics</span></a>) will have to obey these call signatures to ensure a consistent computational framework.</p>
<p>The forward model is passed to the ODE solver upon instantiating the <code class="docutils literal notranslate"><span class="pre">ODESolver</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diabayes.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">ODESolver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ODESolver</span><span class="p">(</span><span class="n">forward_model</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ODESolver</span></code> class implements several wrappers around <code class="docutils literal notranslate"><span class="pre">Forward.__call__</span></code> to make it compatible with SciPy’s <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html"><code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code></a> routine for single forward calculations, or the (<code class="docutils literal notranslate"><span class="pre">vmap</span></code>ped) <a class="reference external" href="https://docs.kidger.site/diffrax/api/diffeqsolve/"><code class="docutils literal notranslate"><span class="pre">diffrax.diffeqsolve</span></code></a> routine for parallelised forward passes during inversion. The inversion methods implemented by this class are discussed in the <a class="reference internal" href="../inversion/index.html"><span class="doc std std-doc">Inverse modelling</span></a> section.</p>
<div class="toctree-wrapper compound">
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id3">
<div role="list" class="citation-list">
<div class="citation" id="id4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Patrick Kidger. <em>On Neural Differential Equations</em>. PhD thesis, University of Oxford, 2021.</p>
</div>
<div class="citation" id="id5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Chris Marone. On the rate of frictional healing and the constitutive law for time- and slip-dependent friction. <em>International Journal of Rock Mechanics and Mining Sciences</em>, 1997. <a class="reference external" href="https://doi.org/10.1016/s1365-1609(97)00054-3">doi:10.1016/s1365-1609(97)00054-3</a>.</p>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User Guide</p>
      </div>
    </a>
    <a class="right-next"
       href="rate-and-state.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Rate-and-state friction</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#friction-models">Friction models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-in-diabayes">Implementation in DiaBayes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Martijn van den Ende.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>